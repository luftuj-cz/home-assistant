{
  "code": "atrea-am-cf",
  "name": "Atrea Duplex AM.CF",
  "variables": [
    {
      "name": "power",
      "type": "number",
      "editable": true,
      "label": { "text": "hru.power", "translate": true },
      "unit": "m³/h",
      "min": 0,
      "maxConfigurable": true,
      "step": 10,
      "class": "power"
    },
    {
      "name": "temperature",
      "type": "number",
      "editable": true,
      "label": { "text": "hru.temperature", "translate": true },
      "unit": "˚C",
      "min": 10,
      "max": 40,
      "maxConfigurable": false,
      "step": 1,
      "class": "temperature"
    },
    {
      "name": "mode",
      "label": { "text": "hru.mode", "translate": true },
      "type": "select",
      "class": "mode",
      "options": [
        { "value": 0, "label": { "text": "hru.modes.off", "translate": true } },
        { "value": 2, "label": { "text": "hru.modes.ventilation", "translate": true } },
        { "value": 5, "label": { "text": "hru.modes.bypass", "translate": true } },
        { "value": 6, "label": { "text": "hru.modes.disbalance", "translate": true } },
        { "value": 7, "label": { "text": "hru.modes.overpressure", "translate": true } }
      ]
    }
  ],
  "interface-type": "modbus-tcp",
  "integration": {
    "read": [
      {
        "type": "assignment",
        "variable": "$power",
        "value": {
          "function": "multiply",
          "args": [{ "function": "modbus_read_input", "args": [1005, 1] }, 10]
        }
      },
      {
        "type": "assignment",
        "variable": "$temperature",
        "value": {
          "function": "multiply",
          "args": [{ "function": "modbus_read_input", "args": [1002, 1] }, 0.1]
        }
      },
      {
        "type": "assignment",
        "variable": "$mode",
        "value": { "function": "modbus_read_input", "args": [1001, 1] }
      }
    ],
    "write": [
      {
        "type": "action",
        "expression": {
          "function": "modbus_write_holding",
          "args": [
            1005,
            {
              "function": "round",
              "args": [{ "function": "multiply", "args": ["$power", 0.1] }]
            }
          ]
        }
      },
      {
        "type": "action",
        "expression": {
          "function": "modbus_write_holding",
          "args": [
            1002,
            {
              "function": "round",
              "args": [{ "function": "multiply", "args": ["$temperature", 10] }]
            }
          ]
        }
      },
      {
        "type": "action",
        "expression": { "function": "modbus_write_holding", "args": [1001, "$mode"] }
      }
    ]
  }
}
